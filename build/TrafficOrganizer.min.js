/*
 * Copyright (C) 2010	Mike Sukmanowski (mike.sukmanowsky@oddinteractive.com)
*/
TrafficOrganizer=function(z){TrafficOrganizer.VERSION="1.0";var J;var n;var x;var D;var I;var i;var P;var m;var v;var d;var F;var w;var M;var A;var h;var l;var r;var u;var j;var b;var t;var k;var a;var o;var B;var f;var K;var p;this.getFirstPageOnly=function(){return p;};this.setFirstPageOnly=function(s){p=s;};this.addPaidSearchParameter=function(s){v.push(s);};this.clearPaidSearchParameters=function(){paidSearchParmaeters=new Array();};this.addSearchEngine=function(s,S,R){D.push([s,S,R]);};this.addReferrerGroup=function(S,R,s){i.push([S,R,s]);};this.clearAllReferrerGroups=function(){i=new Array();};this.addSearchKeywordGroup=function(s,R){I.push([s,R]);};this.clearAllSearchKeywordGroups=function(){I=new Array();};this.addIgnoredReferrer=function(s){P.push(s);};this.clearIgnoredReferrers=function(){P=new Array();};this.addIgnoredSearchKeyword=function(s){m.push(s);};this.clearIgnoredSearchKeywords=function(){m=new Array();};this.getMedium=function(){return h;};this.getSource=function(){return r;};this.getContent=function(){return j;};this.getKeyword=function(){return a;};this.getKeywordGroup=function(){return o;};this.getCampaign=function(){return t;};this.getReferringPath=function(){return K;};this.getReferringDomain=function(){return f;};this.setMediumKeyName=function(s){A=s;};this.setSourceKey=function(s){l=s;};this.setContentKey=function(s){u=s;};this.setKeywordKey=function(s){k=s;};this.setCampaignKey=function(s){b=s;};this.setCookieName=function(s){x=s;};this.getCookieName=function(){return x;};this.setCookieTimeout=function(s){n=s;};this.getCookieTimeout=function(){return n;};this.getDirectMediumName=function(){return d;};this.setDirectMediumName=function(s){d=s;};this.getReferralMediumName=function(){return F;};this.setReferralMediumName=function(s){F=s;};this.getOrganicMediumName=function(){return w;};this.setOrganicMediumName=function(s){w=s;};this.getPPCMediumName=function(){return M;};this.setPPCMediumName=function(s){M=s;};this.resetKeys=function(){A="utm_medium";l="utm_source";b="utm_campaign";k="utm_term";u="utm_content";};this.resetAll=function(){this.resetKeys();n=1800000;x="_ga_tsm";h="";r="";t="";o="";j="";B=document.referrer;f=O(B);K=c(B);I=new Array();i=new Array();P=new Array();m=new Array();v=new Array();P.push(O(document.location.href.toLowerCase()));d="Direct / Brand Aware: Typed / Bookmarked / etc";F="Referrer: Organic";w="Search Engine: Organic";M="Search Engine: Paid";p=true;};this.track=function(){var s=false;if(!q()){s=true;}else{var S=J.getQueryParam(l);var R=J.getQueryParam(A);if((N(f,P)==-1)||(S!=""&&R!="")){s=true;}}if(s){G();L();}else{C();if(p){E();}}};function G(){h=J.getQueryParam(A);r=J.getQueryParam(l);t=J.getQueryParam(b);j=J.getQueryParam(u);a=J.getQueryParam(k);o="";if(r==""||h==""){h="";r="";t="";j="";a="";o="";if(B==""){h=d;r="(none)";}else{if(!g()){if(!y()){h=F;r=f;}}}}}function E(){h="";r="";t="";j="";a="";o="";f="";K="";}function y(){if(N(f,P)>=0){h=d;r=f;return true;}for(var s=0;s<i.length;s++){if(N(f,i[s][0])>=0){h=i[s][1];r=e(i[s][2]);return true;}}return false;}function g(){var R=false;for(var V=0;(V<D.length)&&!R;V++){if(f.indexOf(D[V][0])>=0){R=true;var S=false;for(var U=0;(U<v.length)&&!S;U++){if(J.getQueryParam(v[U])!=""){S=true;}}h=S?M:w;r=D[V][2];a=J.getQueryParam(D[V][1],"",B).toLowerCase();a=a.toLowerCase();var T=false;for(var U=0;(U<m.length)&&!T&&!S;U++){if(typeof(m[U])=="string"){T=a==m[U];}else{if(typeof(m[U])=="object"&&m[U].test){T=m[U].test(a);}}}if(T&&!S){h=d;}if(!T){var s=false;for(var U=0;(U<I.length)&&!s;U++){if(typeof(I[U][0])=="string"){s=(I[U][0].indexOf(a)>=0);}else{if(typeof(I[U][0])=="object"&&I[U][0].test){s=I[U][0].test(a);}}if(s){o=I[U][1];}}}else{o="Brand Aware Keywords / Direct Traffic";}}}return R;}function O(S){var R="";if(S){var T=S.indexOf("//");var s=S.indexOf("/",T+2);R=S.substring(T+2,s);R=R.replace("www.","");}return R;}function c(R){var T="";if(R){var s=R.indexOf("//");s=R.indexOf("/",s+2);var S=R.indexOf("?",s)>=0?R.indexOf("?",s):R.length;T=R.substring(s,S);}return T;}function e(s){var R=s;R=R.replace(/\%rd/g,f);R=R.replace(/\%rp/g,K);R=R.replace(/\%m/g,h);R=R.replace(/\%s/g,r);R=R.replace(/\%cp/g,t);R=R.replace(/\%c/g,j);R=R.replace(/\%kg/g,o);R=R.replace(/\%k/g,a);return R;}function q(){return(J.c_r(x)?true:false);}function C(){var T=J.c_r(x);if(!T){return false;}else{T=T.split("|");for(var R=0;R<T.length;R++){var s=T[R].split("=")[0];var S=Q(T[R].split("=")[1]);switch(s){case"m":h=S;break;case"s":r=S;break;case"k":a=S;break;case"kg":o=S;break;case"c":j=S;break;case"cp":t=S;break;case"rp":K=S;break;case"rd":f=S;break;}}return true;}}function L(){var R="";R+="m="+H(h);R+="|s="+H(r);if(a){R+="|k="+H(a);}if(o){R+="|kg="+H(o);}if(j){R+="|c="+H(j);}if(t){R+="|cp="+H(t);}if(K){R+="|rp="+H(K);}if(f){R+="|rd="+H(f);}var s=new Date();s.setTime(s.getTime()-1*24*60*60*1000);J.c_w(x,"",s);s=new Date();s.setTime(s.getTime()+n);J.c_w(x,R,s);}function H(s){s=s.replace("|","~!~");s=encodeURIComponent(s);return s;}function Q(s){s=decodeURIComponent(s);s=s.replace("~!~","|");return s;}function N(S,T,R){if(R===undefined){R=false;}if(T.indexOf&&typeof(T)=="string"){return T.indexOf(S);}for(var s=0;s<T.length;s++){if(T[s].test){if(T[s].test(S)){return s;}}else{if(R){if(T[s].indexOf(S)>=0){return s;}}else{if(T[s]===S){return s;}}}}return -1;}D=new Array(["daum","q","Daum"],["eniro","search_word","Eniro"],["naver","query","Naver"],["google","q","Google"],["yahoo","p","Yahoo"],["msn","q","MSN"],["bing","q","Bing"],["aol","query,encquery","AOL"],["lycos","query","Lycos"],["ask","q","Ask"],["altavista","q","Altavista"],["search.netscape","query","Netscape"],["cnn","query","CNN"],["about","terms","About"],["mamma","query","Mamma"],["alltheweb","q","Alltheweb"],["voila.fr","rdata","Voila"],["virgilio","qs","Virgilio"],["baidu","wd","Baidu"],["alice","qs","Alice"],["yandex","text","Yandex"],["najdi.org.mk","q","Najdi"],["seznam.cz","q","Seznam"],["search.com","q","Search.com"],["wp.pl","szukaj","Wirtulana Polska"],["onetcenter","qt","O*NET"],["szukacz","q","Szukacz"],["yam","k","Yam"],["pchome","q","PCHome"],["kvasir","q","Kvasir"],["sesam","q","Sesam"],["ozu","q","Ozu"],["terra","query","Terra"],["mynet","q","Mynet"],["ekolay","q","Ekolay"],["rambler","words","Rambler"]);J=z;this.resetAll();};